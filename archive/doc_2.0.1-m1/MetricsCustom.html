<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Jagger: Custom metrics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Jagger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<link href="tab-panel.css" rel="stylesheet" type="text/css">
  <script language="type="text/javascript"JavaScript" type="text/javascript" src="tab-panel.js">
  </script></head>
</head>
<body onload="bodyOnLoad()" onresize="raisePanel(currentMenuIndex)">
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('MetricsCustom.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Custom metrics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><br/>
 We consider you are already familiar with the general approach for metrics <a class="el" href="MetricsMain.html">aggregation and storage</a> <br/>
 <br/>
 Jagger test framework allows to work with custom performance metrics. That means, you can create, collect, aggregate, store and make pass/fail decision based on you own metrics.</p>
<dl class="section user"><dt>Custom metrics collection</dt><dd>Framework is exposing <a class="el" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1services_1_1DefaultMetricService.html">metric service</a> to work with custom metrics <br/>
 MetricService allows to:<ul>
<li>create metric<ul>
<li>set unique id of the metric</li>
<li>set display name - text, displayed in the reports</li>
<li>set flags what values will be aggregated (summary, detailed results)</li>
<li>set what aggregator(s) will be used for this metric</li>
</ul>
</li>
<li>save metric values</li>
</ul>
</dd></dl>
<p>you can find more details about Jagger services in the chapter <a class="el" href="ListenersMain.html">User actions during the load test</a></p>
<dl class="section user"><dt>Custom metrics collection. Case 1</dt><dd>In the example we are creating metric before running performance test and saving values on every successful request to the SUT. After test is over, results for this metric will be aggregated by multiple aggregators. More details about metrics collection you can find in the chapter <a class="el" href="MetricsMain.html">Collecting metrics</a> <div class="fragment"><div class="line"><span class="keyword">package </span>com.griddynamics.jagger.engine.e1.collector.invocation;</div>
<div class="line"></div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.Provider;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.AvgMetricAggregatorProvider;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.MaxMetricAggregatorProvider;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.MetricDescription;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.MinMetricAggregatorProvider;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.PercentileAggregatorProvider;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.invocation.InvocationInfo;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.collector.invocation.InvocationListener;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.engine.e1.services.ServicesAware;</div>
<div class="line"><span class="keyword">import</span> com.griddynamics.jagger.invoker.InvocationException;</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>ExampleInvocationListener <span class="keyword">extends</span> ServicesAware implements Provider&lt;InvocationListener&gt; {</div>
<div class="line"></div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String metricName = <span class="stringliteral">&quot;example-duration-metric&quot;</span>;</div>
<div class="line"></div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1invocation_1_1ExampleInvocationListener_aee73bfad256bb1d38a99a56280edda7c.html#aee73bfad256bb1d38a99a56280edda7c">init</a>() {</div>
<div class="line"></div>
<div class="line">        <span class="comment">//begin: following section is used for docu generation - example of the metric with multiple aggregators</span></div>
<div class="line">        getMetricService().createMetric(<span class="keyword">new</span> MetricDescription(metricName)</div>
<div class="line">                .displayName(<span class="stringliteral">&quot;Example duration metric, ms&quot;</span>)</div>
<div class="line">                .showSummary(<span class="keyword">true</span>)</div>
<div class="line">                .plotData(<span class="keyword">true</span>)</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> MinMetricAggregatorProvider())</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> MaxMetricAggregatorProvider())</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> AvgMetricAggregatorProvider())</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(40D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(50D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(60D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(70D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(80D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(90D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(95D))</div>
<div class="line">                .addAggregator(<span class="keyword">new</span> PercentileAggregatorProvider(99D))</div>
<div class="line">        );</div>
<div class="line">        <span class="comment">//end: following section is used for docu generation - example of the metric with multiple aggregators</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> InvocationListener <a class="code" href="classcom_1_1griddynamics_1_1jagger_1_1engine_1_1e1_1_1collector_1_1invocation_1_1ExampleInvocationListener_a0d45fd2dbc566ec3bf3d6bcc948cb036.html#a0d45fd2dbc566ec3bf3d6bcc948cb036">provide</a>() {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> InvocationListener() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onStart(InvocationInfo invocationInfo) { }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onSuccess(InvocationInfo invocationInfo) {</div>
<div class="line">                <span class="keywordflow">if</span> (invocationInfo.getResult() != null) {</div>
<div class="line">                    getMetricService().saveValue(metricName, invocationInfo.getDuration());</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onFail(InvocationInfo invocationInfo, InvocationException e) { }</div>
<div class="line"></div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> onError(InvocationInfo invocationInfo, Throwable error) { }</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Custom metrics collection. Case 2</dt><dd>Another option: you can collect metrics with some external tool. After test is over you can read time series values from this tool as store them in the framework DB. In this case you can execute your code in the <a class="el" href="ListenersMain.html#section_listeners_intro">test or test group listener</a> in the onStop method </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="MetricsMain.html">Collecting metrics</a></li>
    <li class="footer">Generated on Thu Mar 2 2017 21:43:20 for Jagger by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
