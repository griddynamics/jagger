<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
        xmlns="http://www.griddynamics.com/schema/jagger"
        xmlns:beans="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
        http://www.griddynamics.com/schema/jagger
        http://www.griddynamics.com/schema/jagger.xsd
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd">

    <beans:import resource="test.description.conf.xml"/>

    <!-- Standard Load/Termination/Limits settings for a test. A test still may have custom Load/Termination/Limits settings. -->
    <test id="t_JaaS_Standard_load_termination">
        <load xsi:type="load-user-groups">
            <user count="2" startCount="2" startIn="0" startBy="0" life="${jaas.std.tst.life}"/>
        </load>
        <termination xsi:type="termination-iterations" iterations="${jaas.std.tst.iterations}"
                     maxDuration="${jaas.std.tst.max_duration}"/>
    </test>

    <test id="t_JaaS_Standard" parent="t_JaaS_Standard_load_termination">
        <limits xsi:type="limits-ref" ref="test_limits"/>
    </test>

    <test id="t_JaaS_Standard_One_invocation_no_limits">
        <load xsi:type="load-invocation" exactcount="1" threads="1" period="1s"/>
        <termination xsi:type="termination-iterations" iterations="1" maxDuration="1s"/> <!-- We do not want tons of records to be affected.-->
    </test>

    <test id="t_JaaS_Standard_One_invocation" parent="t_JaaS_Standard_One_invocation_no_limits">
        <limits xsi:type="limits-ref" ref="test_limits"/>
    </test>


    <!--Name of workload configuration-->
    <configuration id="JaaS_TestConfiguration">
        <latency-percentiles>
            <percentile>99</percentile>
        </latency-percentiles>

        <test-suite id="ts_JaaSTestSuit">
            <test-group id="tg_JaaS_GET_Sessions">
                <test id="t_JaaS_GET_Sessions_List_SR_eq._1.0" testDescription="td_JaaS_SessionsList" parent="t_JaaS_Standard"/>

                <test id="t_JaaS_GET_Exact_Session_SR_eq._1.0" testDescription="td_JaaS_ExactSessionIds" parent="t_JaaS_Standard"/>
            </test-group>

            <test-group id="tg_JaaS_GET_Tests">
                <test id="t_JaaS_GET_Session_Tests_List_SR_eq._1.0" testDescription="td_JaaS_SessionTestsList" parent="t_JaaS_Standard"/>

                <!-- Test may fail due to JFG-930 -->
                <test id="t_JaaS_GET_Exact_Session_Test_SR_eq._1.0" testDescription="td_JaaS_ExactSessionTest" parent="t_JaaS_Standard"/>
            </test-group>

            <test-group id="tg_JaaS_GET_Metrics">
                <test id="t_JaaS_GET_Metrics_List_SR_eq._1.0" testDescription="td_JaaS_MetricsList" parent="t_JaaS_Standard"/>
            </test-group>

            <test-group id="tg_JaaS_GET_Metric_Summaries">
                <test id="t_JaaS_GET_Metric_Summary_List_SR_eq._1.0" testDescription="td_JaaS_MetricSummaryList" parent="t_JaaS_Standard"/>
            </test-group>

            <test-group id="td_JaaS_MetricPlotList">
                <test id="t_JaaS_GET_Metric_Plot_List_SR_eq._1.0" testDescription="td_JaaS_MetricPlotList" parent="t_JaaS_Standard"/>
            </test-group>
            <test-group id="tg_JaaS_GET_DB_configs">
                <test id="t_JaaS_GET_DBs_List_SR_eq._1.0" testDescription="td_JaaS_DBsList" parent="t_JaaS_Standard"/>

                <test id="t_JaaS_GET_Exact_DB_SR_eq._1.0" testDescription="td_JaaS_ExactDBsIds" parent="t_JaaS_Standard"/>

                <test id="t_JaaS_GET_DBsIds_Non_Numeric" testDescription="td_JaaS_DBsIds_Non_Numeric" parent="t_JaaS_Standard_load_termination"/>

                <test id="t_JaaS_GET_DBsIds_Not_Existent" testDescription="td_JaaS_DBsIds_Not_Existent" parent="t_JaaS_Standard_load_termination"/>
            </test-group>

            <test-group id="tg_JaaS_POST_DB_configs">
                <test id="t_JaaS_POST_DB_SR_eq._1.0" testDescription="td_JaaS_Create_DB" parent="t_JaaS_Standard_One_invocation"/>
            </test-group>
            <test-group id="tg_JaaS_GET_After_POST_DB_configs"> <!-- Shall be executed right after the POST test group to verify what actually was created. -->
                <test id="t_JaaS_GET_Created_DB_SR_eq._1.0" testDescription="td_JaaS_CreatedDBsIds" parent="t_JaaS_Standard"/>
            </test-group>
            <test-group id="tg_JaaS_PUT_After_POST_DB_configs"> <!-- Shall be executed after the POST test group to modify what actually was created. -->
                <test id="t_JaaS_PUT_Created_DB_SR_eq._1.0" testDescription="td_JaaS_Update_DB" parent="t_JaaS_Standard"/>
            </test-group>
            <test-group id="tg_JaaS_DELETE_DB_configs">
                <test id="t_JaaS_DELETE_DB_SR_eq._1.0" testDescription="td_JaaS_Delete_DB" parent="t_JaaS_Standard_One_invocation"/>
            </test-group>
            <test-group id="tg_JaaS_GET_After_DELETE_DB_configs">
                <test id="t_JaaS_GET_Deleted_DB" testDescription="td_JaaS_DeletedDBsIds" parent="t_JaaS_Standard_One_invocation_no_limits">
                    <listeners-test>
                        <listener-test xsi:type="listener-test-ref" ref="listenerAfterCreateDbTestsCleanUp"/>
                    </listeners-test>
                </test>
            </test-group>

            <listeners-test-suite>
                <listener-test-suite xsi:type="listener-test-suite-ref" ref="listenerTestSuite"/>
            </listeners-test-suite>
        </test-suite>

        <report outputReportLocation="jaas-test-report.pdf"/>

    </configuration>
</beans:beans>
